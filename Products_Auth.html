<!DOCTYPE html>
<html>
<head>
    <title>Authenticated Products - LP Brand Store</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <!-- BEGIN LivePerson Monitor. -->
    <script type="text/javascript">
        // Define the validateToken function to check if the user is authenticated
        function validateToken() {
            // Simulated logic to check if the user is authenticated
            const token = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJNb2hhbW1lZCBKYWZmZXIgSXNsYW0gLSA5MTA3NzkiLCJpc3MiOiJodHRwczovL2p3dC5pby8iLCJhdWQiOiJhY2M6cWE1NzIyMTY3NiIsImV4cCI6MTk5MjAyNTk5MiwiaWF0IjoxNjgyMDMwOTU0LCJhY3IiOiJsb2ExIn0.L1B2r_KuK7AN9XmvxyXUuNTZQS1JQXGQH169jxkkRWGLpp1GwgEInkxyaueN7FAXNtNugPrfbAqyW_F2qoXGxSGirTTnk_p8g9r9PDteP-JA7eq4qxEgbtrBnSTVFA8kmY7E9GPahHnabRDt-89w6Oi3rmzs1k5CP8HkKhwadTKEAgZ8t6X2vsr1-mWi9txTjwNMjTOo9EVxgr7z31q0Kxn-XTf3zxRalQWHNS8lA00f3v7CafXl6TeXCj4Ck69LakJAu5uGW5PcVvjq4jDsqw5Siw2A1UnM3xfQ8I6iz1_IADjPWVHVcFf0IPMuZsRZ1A5rFII79VUP3ujdsv3_BA";
            
            // Check if the token is valid (you should implement your own logic here)
            if (token) {
                return true;
            } else {
                return false;
            }
        }

        // Function to update LP tag with cart information
        function updateLPTag(cartValue) {
            const title = document.title;
            const x = cartValue.toFixed(2); // Format cartValue as a number with 2 decimal places

            lpTag.sdes = lpTag.sdes || [];
            lpTag.sdes.push({
                "type": "cart",
                "total": x, // Set the total to the formatted cartValue
                "currency": "USD",
                "numItems": x, // Assuming numItems should also be the formatted cartValue
                "products": [{
                    "product": {
                        "name": "Page Title: " + title,
                        "category": ""
                    },
                }]
            });
        }
    
     
    
        const identityFn = function(callback) {
            callback({
    "sub": "Mohammed Jaffer Islam - 910779",
     "iss": "https://jwt.io/",
     "aud": "acc:qa57221676",
     "exp": 1992025992,
     "iat": 1682030954,
     "acr": "loa1"
     });
        };
    
     
    
        var id_token = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJNb2hhbW1lZCBKYWZmZXIgSXNsYW0gLSA5MTA3NzkiLCJpc3MiOiJodHRwczovL2p3dC5pby8iLCJhdWQiOiJhY2M6cWE1NzIyMTY3NiIsImV4cCI6MTk5MjAyNTk5MiwiaWF0IjoxNjgyMDMwOTU0LCJhY3IiOiJsb2ExIn0.L1B2r_KuK7AN9XmvxyXUuNTZQS1JQXGQH169jxkkRWGLpp1GwgEInkxyaueN7FAXNtNugPrfbAqyW_F2qoXGxSGirTTnk_p8g9r9PDteP-JA7eq4qxEgbtrBnSTVFA8kmY7E9GPahHnabRDt-89w6Oi3rmzs1k5CP8HkKhwadTKEAgZ8t6X2vsr1-mWi9txTjwNMjTOo9EVxgr7z31q0Kxn-XTf3zxRalQWHNS8lA00f3v7CafXl6TeXCj4Ck69LakJAu5uGW5PcVvjq4jDsqw5Siw2A1UnM3xfQ8I6iz1_IADjPWVHVcFf0IPMuZsRZ1A5rFII79VUP3ujdsv3_BA";
    
     
    
        lpTag.identities.push(identityFn);
    
     
    
        function lpGetAuthenticationToken(callback) {
            console.log("LP asked for id_token or auth code in Code Flow");
            // Do your magicâ€¦
            // On Success
            callback(id_token);
            // On Failure
            callback("", "error reason");
        }

        // ... (the rest of your LP code)
    </script>
    <!-- END LivePerson Monitor. -->
</head>
<body>
    <header>
        <div class="brand-name">LP Brand Store</div>
        <div class="menu-links">
            <a href="index.html" class="button">Home</a>
            <a href="Products_Auth.html" class="button">Shop (Authenticated)</a>
            <a href="cart.html" class="button" id="cart-button">View Cart (0)</a>
        </div>
    </header>
    <main>
        <div class="center-content">
            <h1>Authenticated Products</h1>
            <div class="product-list">
                <div class="product">
                    <h3>Product 1</h3>
                    <p>Description: This is an authenticated product.</p>
                    <p class="price">Price: $29.99</p>
                    <button class="add-to-cart" data-product-id="product1" data-price="29.99" data-product-name="Product 1">Add to Cart</button>
                </div>
                <div class="product">
                    <h3>Product 2</h3>
                    <p>Description: This is another authenticated product.</p>
                    <p class="price">Price: $34.99</p>
                    <button class="add-to-cart" data-product-id="product2" data-price="34.99" data-product-name="Product 2">Add to Cart</button>
                </div>
                <!-- Add more authenticated products as needed -->
            </div>
        </div>
    </main>
    <script>
        // Check if the user is authenticated
        const isAuthenticated = validateToken();

        // Cart functionality
        const cart = JSON.parse(localStorage.getItem("cart")) || {};

        // Function to update the cart display
        function updateCartDisplay() {
            const cartButton = document.getElementById("cart-button");
            if (cartButton) {
                const itemCount = Object.keys(cart).length;
                cartButton.textContent = `View Cart (${itemCount})`;
            }
        }

        Document.addEventListener("DOMContentLoaded", function() {
            const addToCartButtons = document.querySelectorAll(".add-to-cart-button");
            const cartValueElement = document.querySelector(".cart-value");
            const cartIcon = document.querySelector(".cart-icon");
            let cartValue = 0;

            addToCartButtons.forEach(button => {
                button.addEventListener("click", function() {
                    const productName = this.getAttribute("data-product");
                    const productPrice = parseFloat(this.getAttribute("data-price"));

                    cartValue += productPrice;
                    cartValueElement.textContent = cartValue.toFixed(2);
                    cartIcon.textContent = "ðŸ›’";

                    alert(`${productName} added to cart. Price: $${productPrice}`);

                    updateLPTag(cartValue);
                });
            });

            const logoutButton = document.getElementById("logout");
            logoutButton.addEventListener("click", function() {
                window.location.href = "login.html";
            });
        });
    </script>
</body>
</html>
